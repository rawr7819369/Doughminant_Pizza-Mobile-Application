<ion-header>
  <ion-toolbar color="warning">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/order-history"></ion-back-button>
    </ion-buttons>
    <ion-title>Order Tracking</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="tracking-content">
  <div *ngIf="!order" class="not-found">
    <ion-icon name="alert-circle-outline" size="large"></ion-icon>
    <h3>Order Not Found</h3>
    <p>This order doesn't exist or has been removed.</p>
    <ion-button fill="outline" color="warning" routerLink="/order-history">
      View Order History
    </ion-button>
  </div>

  <div *ngIf="order" class="order-details">
    <!-- Order Info Card -->
    <ion-card class="info-card">
      <ion-card-content>
        <div class="order-header">
          <div>
            <h2>Order #{{ order.id.substring(0, 8) }}</h2>
            <p class="order-date">{{ formatDate(order.date) }}</p>
          </div>
          <ion-badge [color]="order.status === 'delivered' ? 'success' : 'warning'">
            {{ order.status }}
          </ion-badge>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Status Timeline -->
    <ion-card class="status-card">
      <ion-card-content>
        <h3>Order Status</h3>
        <div class="status-timeline">
          <div *ngFor="let step of statusSteps; let i = index" class="status-step" [class.active]="isStepActive(i)" [class.completed]="isStepCompleted(i)">
            <div class="step-icon">
              <ion-icon [name]="step.icon"></ion-icon>
            </div>
            <div class="step-content">
              <h4>{{ step.label }}</h4>
            </div>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Order Items -->
    <ion-card class="items-card">
      <ion-card-content>
        <h3>Order Items</h3>
        <div *ngFor="let item of order.items" class="tracking-item">
          <div class="item-info">
            <h4>{{ item.pizza.name }}</h4>
            <p>{{ item.size }} â€¢ Qty: {{ item.quantity }}</p>
          </div>
          <div class="item-price">
            ${{ (item.pizza.price * item.quantity).toFixed(2) }}
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Order Summary -->
    <ion-card class="summary-card">
      <ion-card-content>
        <h3>Order Summary</h3>
        <div class="summary-row">
          <span>Subtotal:</span>
          <span>${{ order.subtotal.toFixed(2) }}</span>
        </div>
        <div class="summary-row">
          <span>Delivery Fee:</span>
          <span>${{ order.deliveryFee.toFixed(2) }}</span>
        </div>
        <div class="summary-row total">
          <strong>Total:</strong>
          <strong>${{ order.total.toFixed(2) }}</strong>
        </div>
        <div *ngIf="order.address" class="delivery-info">
          <h4>Delivery Address</h4>
          <p>{{ order.address }}</p>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>

